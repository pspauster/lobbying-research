---
title: "JCOPE ANALYSIS"
author: "Patrick Spauster"
date: "2023-09-18"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(googlesheets4)
library(janitor)
library(RPublica) #https://www.r-project.org/nosvn/pandoc/RPublica.html
library(curl)
library(httr)
library(jsonlite)
library(RSocrata)

knitr::opts_chunk$set(echo = TRUE)
```

https://data.ny.gov/Transparency/Disbursement-of-Public-Monies-Bi-Monthly-Report-Be/i574-v3dp
```{r}

clients <- read_csv("https://data.ny.gov/resource/t9kf-dqbc.csv?$select=contractual_client_name,COUNT(contractual_client_name)&$group=contractual_client_name&$LIMIT=100000")

lobbyists <- read_csv("https://data.ny.gov/resource/t9kf-dqbc.csv?$select=principal_lobbyist_name,COUNT(principal_lobbyist_name)&$group=principal_lobbyist_name&$LIMIT=100000")

beneficial <- read_csv("https://data.ny.gov/resource/t9kf-dqbc.csv?$select=beneficial_client_name,COUNT(beneficial_client_name)&$group=beneficial_client_name&$LIMIT=100000")

```


```{r}

url <- URLencode("https://data.ny.gov/resource/t9kf-dqbc.csv?contractual_client_name=REAL ESTATE BOARD OF NEW YORK, INC.&$limit=20000")

rebny <- read_csv(url)

taxpayers <- read_csv(URLencode(
  "https://data.ny.gov/resource/t9kf-dqbc.csv?contractual_client_name=TAXPAYERS FOR AN AFFORDABLE NY, INC.&$limit=20000"
))

homeowners <- read_csv(URLencode(
  "https://data.ny.gov/resource/t9kf-dqbc.csv?contractual_client_name=Homeowners for an Affordable New York LLC&$limit=20000"
))

combined <- read_csv(URLencode(
  "https://data.ny.gov/resource/t9kf-dqbc.csv?$where=beneficial_client_name = 'TAXPAYERS FOR AN AFFORDABLE NY, INC.' OR beneficial_client_name = 'Homeowners for an Affordable New York LLC' OR beneficial_client_name='REAL ESTATE BOARD OF NEW YORK, INC.' OR principal_lobbyist_name = 'TAXPAYERS FOR AN AFFORDABLE NY, INC.' OR principal_lobbyist_name = 'Homeowners for an Affordable New York LLC' OR principal_lobbyist_name='REAL ESTATE BOARD OF NEW YORK, INC.' &$LIMIT= 100000"))


```























```{r}

sof <- read_sheet("https://docs.google.com/spreadsheets/d/1G_5dkzSlSvbVwM7Q-NItgntBawFXDoZaFoq4XPoTSLE/edit#gid=78477068", 
                  sheet = "Sources of Funding",
                  col_types = "ccccDd????") %>% 
  clean_names()

```

```{r}
sof %>% 
  group_by(name) %>% 
  summarize(total_contributions = sum(amount_of_contribution, na.rm = T),
            )

sof %>% 
  filter(!is.na(amount_of_contribution)) %>% 
  count(amount_of_contribution == 0)
```





